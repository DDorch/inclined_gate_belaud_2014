function [z] = Cc(a, s, angle, Modele)
    %-------------------------------------------------------------------------------------------------------
    % Approximate solution for contraction coefficient
    %------------------------------------

    switch Modele
        case 1
            z = 1 - (1.832e-2 * angle - 8.01e-5 * angle^2) * (1 - Ccv(a, s));
            % A reprendre avec nouvel ajustement: Cc(free, angle)= (1.6632E-05*(90-angle)^2 + 2.2521E-03*(90-angle) + 0.611)
        case 2
            z = CcTabul(a, s, angle);
    end

end

function [z] = CcTabul(a, s, angle)
    %definition tabulaire des coefficients de contraction
    % Tableaux des valeurs utilisées
    S = [ 0.0100 0.0700 0.1000 0.2000 0.3000 0.4000 0.5000 0.6000 0.7000 0.8000 0.9000 0.9500 0.9800 0.9900];
    w = [ 0.0100 0.0200 0.0500 0.1000 0.2000 0.3000 0.4000 0.4500 0.5000 0.5500 0.6000 0.6500 0.7000 0.7500 0.8000 0.8500 0.9000 0.9500 1];
    ang = [ 30.0000 45.0000 50.0000 60.0000 70.0000 80.0000 90.0000 100.0000 110.0000 120.0000 130.0000 140.0000 150.0000];

    %Bornage des valeurs
    w1 = max(min(a, 0.999 * max(w)), min(w));
    angle1 = max(min(angle, 0.999 * max(ang)), min(ang));
    s1 = max(min(s, 0.999 * max(S)), min(S));

    %Recherche des indices pour a, s, angle
    k = max(find(s1 >= S));
    j = max(find(angle1 >= ang));
    i = max(find(w1 >= w));

    C(:, :, 1) = [...
                0.7962 0.7463 0.7272 0.6921 0.6614 0.6345 0.6110 0.5905 0.5726 0.5570 0.5436 0.5320 0.5221; ...
                0.8009 0.7462 0.7267 0.6915 0.6606 0.6337 0.6101 0.5896 0.5717 0.5562 0.5428 0.5313 0.5216; ...
                0.8116 0.7455 0.7259 0.6904 0.6595 0.6325 0.6089 0.5884 0.5707 0.5555 0.5425 0.5314 0.5221; ...
                0.8123 0.7442 0.7244 0.6887 0.6576 0.6306 0.6072 0.5871 0.5698 0.5551 0.5427 0.5322 0.5236; ...
                0.8116 0.7418 0.7216 0.6855 0.6544 0.6277 0.6050 0.5858 0.5696 0.5560 0.5447 0.5354 0.5279; ...
                0.8121 0.7402 0.7197 0.6833 0.6524 0.6265 0.6047 0.5864 0.5713 0.5588 0.5485 0.5401 0.5334; ...
                0.8149 0.7402 0.7194 0.6828 0.6524 0.6272 0.6063 0.5890 0.5748 0.5632 0.5538 0.5462 0.5401; ...
                0.8176 0.7413 0.7202 0.6836 0.6534 0.6285 0.6080 0.5912 0.5774 0.5662 0.5571 0.5498 0.5440; ...
                0.8215 0.7433 0.7220 0.6852 0.6551 0.6305 0.6104 0.5939 0.5805 0.5696 0.5608 0.5538 0.5482; ...
                0.8270 0.7466 0.7249 0.6879 0.6579 0.6335 0.6136 0.5974 0.5843 0.5736 0.5651 0.5583 0.5529; ...
                0.8346 0.7517 0.7296 0.6922 0.6619 0.6375 0.6178 0.6017 0.5888 0.5784 0.5700 0.5634 0.5581; ...
                0.8452 0.7594 0.7367 0.6984 0.6677 0.6431 0.6232 0.6072 0.5943 0.5840 0.5757 0.5691 0.5640; ...
                0.8596 0.7711 0.7475 0.7077 0.6760 0.6507 0.6304 0.6141 0.6011 0.5907 0.5824 0.5758 0.5707; ...
                0.8771 0.7891 1.0000 0.7219 0.6882 0.6614 0.6402 0.6232 0.6097 0.5989 0.5904 0.5837 0.5784; ...
                0.8925 0.8164 0.7903 0.9253 0.7077 1.0000 0.6543 0.6357 0.6211 0.6095 0.6004 0.5933 0.5877; ...
                0.9055 0.8470 0.8272 0.7863 0.7442 1.0000 0.6778 0.8718 0.9559 0.6242 0.6138 0.6056 0.5994; ...
                0.9196 0.8776 0.8635 0.8346 0.8040 1.0000 0.7341 0.6925 1.0000 0.6494 0.5129 0.8170 1.0000; ...
                1.0000 1.0000 1.0000 0.8896 0.8716 0.8522 0.8309 0.8070 1.0000 0.7374 0.7081 1.0000 1.0000; ...
                1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000];
    C(:, :, 2) = [...
                0.7962 0.7463 0.7272 0.6921 0.6614 0.6345 0.6110 0.5905 0.5726 0.5570 0.5436 0.5320 0.5221; ...
                0.8012 0.7467 0.7273 0.6921 0.6614 0.6345 0.6111 0.5906 0.5727 0.5573 0.5439 0.5325 0.5228; ...
                0.8123 0.7467 0.7273 0.6921 0.6615 0.6347 0.6113 0.5910 0.5735 0.5583 0.5454 0.5344 0.5252; ...
                0.8123 0.7442 0.7244 0.6889 0.6585 0.6321 0.6093 0.5896 0.5727 0.5583 0.5461 0.5359 0.5275; ...
                0.8116 0.7418 0.7216 0.6855 0.6544 0.6277 0.6050 0.5858 0.5696 0.5560 0.5447 0.5354 0.5279; ...
                0.8121 0.7402 0.7197 0.6833 0.6524 0.6265 0.6047 0.5864 0.5713 0.5588 0.5485 0.5401 0.5334; ...
                0.8149 0.7402 0.7194 0.6828 0.6524 0.6272 0.6063 0.5890 0.5748 0.5632 0.5538 0.5462 0.5401; ...
                0.8176 0.7413 0.7202 0.6836 0.6534 0.6285 0.6080 0.5912 0.5774 0.5662 0.5571 0.5498 0.5440; ...
                0.8215 0.7433 0.7220 0.6852 0.6551 0.6305 0.6104 0.5939 0.5805 0.5696 0.5608 0.5538 0.5482; ...
                0.8270 0.7466 0.7249 0.6879 0.6579 0.6335 0.6136 0.5974 0.5843 0.5736 0.5651 0.5583 0.5529; ...
                0.8346 0.7517 0.7296 0.6922 0.6619 0.6375 0.6178 0.6017 0.5888 0.5784 0.5700 0.5634 0.5581; ...
                0.8452 0.7594 0.7367 0.6984 0.6677 0.6431 0.6232 0.6072 0.5943 0.5840 0.5757 0.5691 0.5640; ...
                0.8596 0.7711 0.7475 0.7077 0.6760 0.6507 0.6304 0.6141 0.6011 0.5907 0.5824 0.5758 0.5707; ...
                0.8771 0.7891 1.0000 0.7219 0.6882 0.6614 0.6402 0.6232 0.6097 0.5989 0.5904 0.5837 0.5784; ...
                0.8925 0.8164 0.7903 0.9253 0.7077 1.0000 0.6543 0.6357 0.6211 0.6095 0.6004 0.5933 0.5877; ...
                0.9055 0.8470 0.8272 0.7863 0.7442 1.0000 0.6778 0.8718 0.9559 0.6242 0.6138 0.6056 0.5994; ...
                0.9196 0.8776 0.8635 0.8346 0.8040 1.0000 0.7341 0.6925 1.0000 0.6494 0.5129 0.8170 1.0000; ...
                1.0000 1.0000 1.0000 0.8896 0.8716 0.8522 0.8309 0.8070 1.0000 0.7374 0.7081 1.0000 1.0000; ...
                1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000];
    C(:, :, 3) = [...
                0.7962 0.7463 0.7272 0.6921 0.6614 0.6345 0.6110 0.5905 0.5726 0.5570 0.5436 0.5320 0.5221; ...
                0.8012 0.7467 0.7273 0.6921 0.6614 0.6345 0.6111 0.5906 0.5727 0.5573 0.5439 0.5325 0.5228; ...
                0.8123 0.7467 0.7273 0.6921 0.6615 0.6347 0.6113 0.5910 0.5735 0.5583 0.5454 0.5344 0.5252; ...
                0.8139 0.7468 0.7274 0.6923 0.6617 0.6352 0.6122 0.5924 0.5755 0.5610 0.5488 0.5386 0.5301; ...
                0.8116 0.7418 0.7216 0.6855 0.6544 0.6277 0.6050 0.5858 0.5696 0.5560 0.5447 0.5354 0.5279; ...
                0.8121 0.7402 0.7197 0.6833 0.6524 0.6265 0.6047 0.5864 0.5713 0.5588 0.5485 0.5401 0.5334; ...
                0.8149 0.7402 0.7194 0.6828 0.6524 0.6272 0.6063 0.5890 0.5748 0.5632 0.5538 0.5462 0.5401; ...
                0.8176 0.7413 0.7202 0.6836 0.6534 0.6285 0.6080 0.5912 0.5774 0.5662 0.5571 0.5498 0.5440; ...
                0.8215 0.7433 0.7220 0.6852 0.6551 0.6305 0.6104 0.5939 0.5805 0.5696 0.5608 0.5538 0.5482; ...
                0.8270 0.7466 0.7249 0.6879 0.6579 0.6335 0.6136 0.5974 0.5843 0.5736 0.5651 0.5583 0.5529; ...
                0.8346 0.7517 0.7296 0.6922 0.6619 0.6375 0.6178 0.6017 0.5888 0.5784 0.5700 0.5634 0.5581; ...
                0.8452 0.7594 0.7367 0.6984 0.6677 0.6431 0.6232 0.6072 0.5943 0.5840 0.5757 0.5691 0.5640; ...
                0.8596 0.7711 0.7475 0.7077 0.6760 0.6507 0.6304 0.6141 0.6011 0.5907 0.5824 0.5758 0.5707; ...
                0.8771 0.7891 1.0000 0.7219 0.6882 0.6614 0.6402 0.6232 0.6097 0.5989 0.5904 0.5837 0.5784; ...
                0.8925 0.8164 0.7903 0.9253 0.7077 1.0000 0.6543 0.6357 0.6211 0.6095 0.6004 0.5933 0.5877; ...
                0.9055 0.8470 0.8272 0.7863 0.7442 1.0000 0.6778 0.8718 0.9559 0.6242 0.6138 0.6056 0.5994; ...
                0.9196 0.8776 0.8635 0.8346 0.8040 1.0000 0.7341 0.6925 1.0000 0.6494 0.5129 0.8170 1.0000; ...
                1.0000 1.0000 1.0000 0.8896 0.8716 0.8522 0.8309 0.8070 1.0000 0.7374 0.7081 1.0000 1.0000; ...
                1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000];
    C(:, :, 4) = [...
                0.7962 0.7463 0.7272 0.6921 0.6614 0.6345 0.6110 0.5905 0.5726 0.5570 0.5436 0.5320 0.5221; ...
                0.8012 0.7467 0.7273 0.6921 0.6614 0.6345 0.6111 0.5906 0.5727 0.5573 0.5439 0.5325 0.5228; ...
                0.8123 0.7467 0.7273 0.6921 0.6615 0.6347 0.6113 0.5910 0.5735 0.5583 0.5454 0.5344 0.5252; ...
                0.8139 0.7468 0.7274 0.6923 0.6617 0.6352 0.6122 0.5924 0.5755 0.5610 0.5488 0.5386 0.5301; ...
                0.8150 0.7476 0.7282 0.6934 0.6635 0.6379 0.6161 0.5976 0.5821 0.5690 0.5582 0.5493 0.5420; ...
                0.8121 0.7402 0.7197 0.6833 0.6536 0.6297 0.6097 0.5930 0.5790 0.5675 0.5581 0.5504 0.5442; ...
                0.8149 0.7402 0.7194 0.6828 0.6524 0.6272 0.6063 0.5890 0.5748 0.5632 0.5538 0.5462 0.5401; ...
                0.8176 0.7413 0.7202 0.6836 0.6534 0.6285 0.6080 0.5912 0.5774 0.5662 0.5571 0.5498 0.5440; ...
                0.8215 0.7433 0.7220 0.6852 0.6551 0.6305 0.6104 0.5939 0.5805 0.5696 0.5608 0.5538 0.5482; ...
                0.8270 0.7466 0.7249 0.6879 0.6579 0.6335 0.6136 0.5974 0.5843 0.5736 0.5651 0.5583 0.5529; ...
                0.8346 0.7517 0.7296 0.6922 0.6619 0.6375 0.6178 0.6017 0.5888 0.5784 0.5700 0.5634 0.5581; ...
                0.8452 0.7594 0.7367 0.6984 0.6677 0.6431 0.6232 0.6072 0.5943 0.5840 0.5757 0.5691 0.5640; ...
                0.8596 0.7711 0.7475 0.7077 0.6760 0.6507 0.6304 0.6141 0.6011 0.5907 0.5824 0.5758 0.5707; ...
                0.8771 0.7891 1.0000 0.7219 0.6882 0.6614 0.6402 0.6232 0.6097 0.5989 0.5904 0.5837 0.5784; ...
                0.8925 0.8164 0.7903 0.9253 0.7077 1.0000 0.6543 0.6357 0.6211 0.6095 0.6004 0.5933 0.5877; ...
                0.9055 0.8470 0.8272 0.7863 0.7442 1.0000 0.6778 0.8718 0.9559 0.6242 0.6138 0.6056 0.5994; ...
                0.9196 0.8776 0.8635 0.8346 0.8040 1.0000 0.7341 0.6925 1.0000 0.6494 0.5129 0.8170 1.0000; ...
                1.0000 1.0000 1.0000 0.8896 0.8716 0.8522 0.8309 0.8070 1.0000 0.7374 0.7081 1.0000 1.0000; ...
                1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000];
    C(:, :, 5) = [...
                0.7962 0.7463 0.7272 0.6921 0.6614 0.6345 0.6110 0.5905 0.5726 0.5570 0.5436 0.5320 0.5221; ...
                0.8012 0.7467 0.7273 0.6921 0.6614 0.6345 0.6111 0.5906 0.5727 0.5573 0.5439 0.5325 0.5228; ...
                0.8123 0.7467 0.7273 0.6921 0.6615 0.6347 0.6113 0.5910 0.5735 0.5583 0.5454 0.5344 0.5252; ...
                0.8139 0.7468 0.7274 0.6923 0.6617 0.6352 0.6122 0.5924 0.5755 0.5610 0.5488 0.5386 0.5301; ...
                0.8148 0.7475 0.7281 0.6934 0.6635 0.6379 0.6161 0.5976 0.5820 0.5690 0.5582 0.5492 0.5420; ...
                0.8176 0.7498 0.7306 0.6965 0.6677 0.6434 0.6231 0.6061 0.5920 0.5803 0.5708 0.5630 0.5567; ...
                0.8149 0.7412 0.7225 0.6899 0.6628 0.6404 0.6218 0.6065 0.5940 0.5837 0.5754 0.5687 0.5633; ...
                0.8176 0.7413 0.7202 0.6836 0.6552 0.6338 0.6162 0.6018 0.5900 0.5804 0.5727 0.5665 0.5615; ...
                0.8215 0.7433 0.7220 0.6852 0.6551 0.6305 0.6104 0.5950 0.5839 0.5749 0.5677 0.5619 0.5574; ...
                0.8270 0.7466 0.7249 0.6879 0.6579 0.6335 0.6136 0.5974 0.5843 0.5736 0.5651 0.5583 0.5529; ...
                0.8346 0.7517 0.7296 0.6922 0.6619 0.6375 0.6178 0.6017 0.5888 0.5784 0.5700 0.5634 0.5581; ...
                0.8452 0.7594 0.7367 0.6984 0.6677 0.6431 0.6232 0.6072 0.5943 0.5840 0.5757 0.5691 0.5640; ...
                0.8596 0.7711 0.7475 0.7077 0.6760 0.6507 0.6304 0.6141 0.6011 0.5907 0.5824 0.5758 0.5707; ...
                0.8771 0.7891 1.0000 0.7219 0.6882 0.6614 0.6402 0.6232 0.6097 0.5989 0.5904 0.5837 0.5784; ...
                0.8925 0.8164 0.7903 0.9253 0.7077 1.0000 0.6543 0.6357 0.6211 0.6095 0.6004 0.5933 0.5877; ...
                0.9055 0.8470 0.8272 0.7863 0.7442 1.0000 0.6778 0.8718 0.9559 0.6242 0.6138 0.6056 0.5994; ...
                0.9196 0.8776 0.8635 0.8346 0.8040 1.0000 0.7341 0.6925 1.0000 0.6494 0.5129 0.8170 1.0000; ...
                1.0000 1.0000 1.0000 0.8896 0.8716 0.8522 0.8309 0.8070 1.0000 0.7374 0.7081 1.0000 1.0000; ...
                1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000];
    C(:, :, 6) = [...
                0.7962 0.7463 0.7272 0.6921 0.6614 0.6345 0.6110 0.5905 0.5726 0.5570 0.5436 0.5320 0.5221; ...
                0.8012 0.7467 0.7273 0.6921 0.6614 0.6345 0.6111 0.5906 0.5727 0.5573 0.5439 0.5325 0.5228; ...
                0.8123 0.7467 0.7273 0.6921 0.6615 0.6347 0.6113 0.5910 0.5735 0.5583 0.5454 0.5344 0.5252; ...
                0.8138 0.7468 0.7273 0.6923 0.6617 0.6352 0.6122 0.5924 0.5755 0.5610 0.5488 0.5386 0.5301; ...
                0.8147 0.7474 0.7280 0.6933 0.6634 0.6378 0.6161 0.5976 0.5820 0.5690 0.5581 0.5492 0.5420; ...
                0.8170 0.7494 0.7302 0.6962 0.6675 0.6432 0.6229 0.6060 0.5919 0.5802 0.5707 0.5629 0.5567; ...
                0.8224 0.7542 0.7353 0.7023 0.6750 0.6524 0.6337 0.6183 0.6056 0.5953 0.5869 0.5801 0.5748; ...
                0.8231 0.7546 0.7359 0.7037 0.6772 0.6555 0.6376 0.6230 0.6111 0.6014 0.5936 0.5873 0.5823; ...
                0.8215 0.7505 0.7321 0.7007 0.6752 0.6544 0.6375 0.6237 0.6125 0.6034 0.5961 0.5903 0.5857; ...
                0.8270 0.7466 0.7253 0.6948 0.6702 0.6504 0.6343 0.6213 0.6107 0.6022 0.5954 0.5900 0.5858; ...
                0.8346 0.7517 0.7296 0.6922 0.6630 0.6440 0.6287 0.6164 0.6065 0.5985 0.5921 0.5871 0.5831; ...
                0.8452 0.7594 0.7367 0.6984 0.6677 0.6431 0.6232 0.6094 0.6000 0.5925 0.5865 0.5818 0.5781; ...
                0.8596 0.7711 0.7475 0.7077 0.6760 0.6507 0.6304 0.6141 0.6011 0.5907 0.5824 0.5758 0.5709; ...
                0.8771 0.7891 1.0000 0.7219 0.6882 0.6614 0.6402 0.6232 0.6097 0.5989 0.5904 0.5837 0.5784; ...
                0.8925 0.8164 0.7903 0.9253 0.7077 1.0000 0.6543 0.6357 0.6211 0.6095 0.6004 0.5933 0.5877; ...
                0.9055 0.8470 0.8272 0.7863 0.7442 1.0000 0.6778 0.8718 0.9559 0.6242 0.6138 0.6056 0.5994; ...
                0.9196 0.8776 0.8635 0.8346 0.8040 1.0000 0.7341 0.6925 1.0000 0.6494 0.5129 0.8170 1.0000; ...
                1.0000 1.0000 1.0000 0.8896 0.8716 0.8522 0.8309 0.8070 1.0000 0.7374 0.7081 1.0000 1.0000; ...
                1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000];
    C(:, :, 7) = [...
                0.7962 0.7463 0.7272 0.6921 0.6614 0.6345 0.6110 0.5905 0.5726 0.5570 0.5436 0.5320 0.5221; ...
                0.8012 0.7467 0.7273 0.6921 0.6614 0.6345 0.6111 0.5906 0.5727 0.5573 0.5439 0.5325 0.5228; ...
                0.8123 0.7467 0.7273 0.6921 0.6615 0.6347 0.6113 0.5910 0.5735 0.5583 0.5454 0.5344 0.5252; ...
                0.8138 0.7468 0.7273 0.6923 0.6617 0.6352 0.6122 0.5924 0.5755 0.5610 0.5488 0.5386 0.5301; ...
                0.8145 0.7473 0.7280 0.6932 0.6634 0.6378 0.6160 0.5975 0.5820 0.5689 0.5581 0.5492 0.5419; ...
                0.8164 0.7491 0.7299 0.6960 0.6673 0.6431 0.6228 0.6058 0.5917 0.5801 0.5706 0.5628 0.5566; ...
                0.8207 0.7532 0.7344 0.7016 0.6744 0.6519 0.6333 0.6179 0.6053 0.5950 0.5866 0.5799 0.5745; ...
                0.8244 0.7567 0.7382 0.7061 0.6797 0.6581 0.6403 0.6257 0.6138 0.6041 0.5963 0.5901 0.5851; ...
                0.8298 0.7617 0.7434 0.7121 0.6866 0.6658 0.6488 0.6350 0.6238 0.6148 0.6075 0.6017 0.5971; ...
                0.8338 0.7651 0.7470 0.7164 0.6918 0.6719 0.6558 0.6428 0.6323 0.6238 0.6170 0.6116 0.6073; ...
                0.8346 0.7644 0.7465 0.7167 0.6929 0.6739 0.6587 0.6464 0.6365 0.6285 0.6222 0.6172 0.6132; ...
                0.8452 0.7613 0.7434 0.7140 0.6910 0.6727 0.6582 0.6465 0.6372 0.6297 0.6238 0.6191 0.6155; ...
                0.8596 0.7711 0.7475 0.7094 0.6867 0.6690 0.6550 0.6438 0.6350 0.6279 0.6223 0.6179 0.6145; ...
                0.8771 0.7891 1.0000 0.7219 0.6882 0.6632 0.6495 0.6386 0.6301 0.6233 0.6180 0.6138 0.6105; ...
                0.8925 0.8164 0.7903 0.9253 0.7077 0.6778 0.6410 0.6309 0.6227 0.6161 0.6109 0.6068 0.6037; ...
                0.9055 0.8470 0.8272 0.7863 0.7442 0.8468 0.8571 0.8722 1.0000 0.6057 0.6007 0.6056 0.5994; ...
                0.9196 0.8776 0.8635 0.8346 0.8040 0.7708 0.7341 0.6925 1.0000 0.7868 0.7963 0.8170 1.0000; ...
                1.0000 1.0000 1.0000 0.8896 0.8716 0.8522 0.8309 0.8070 1.0000 0.7473 0.7081 1.0000 1.0000; ...
                1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000];
    C(:, :, 8) = [...
                0.7962 0.7463 0.7272 0.6921 0.6614 0.6345 0.6110 0.5905 0.5726 0.5570 0.5436 0.5320 0.5221; ...
                0.8012 0.7467 0.7273 0.6921 0.6614 0.6345 0.6111 0.5906 0.5727 0.5573 0.5439 0.5325 0.5228; ...
                0.8123 0.7467 0.7273 0.6921 0.6614 0.6347 0.6113 0.5910 0.5735 0.5583 0.5454 0.5344 0.5252; ...
                0.8138 0.7468 0.7273 0.6922 0.6617 0.6352 0.6122 0.5924 0.5755 0.5610 0.5488 0.5386 0.5301; ...
                0.8144 0.7472 0.7279 0.6932 0.6633 0.6378 0.6160 0.5975 0.5820 0.5689 0.5581 0.5492 0.5419; ...
                0.8159 0.7487 0.7296 0.6957 0.6671 0.6429 0.6226 0.6057 0.5916 0.5800 0.5705 0.5627 0.5565; ...
                0.8192 0.7522 0.7336 0.7010 0.6739 0.6514 0.6329 0.6175 0.6050 0.5947 0.5863 0.5796 0.5743; ...
                0.8220 0.7552 0.7368 0.7050 0.6789 0.6573 0.6396 0.6251 0.6133 0.6036 0.5959 0.5896 0.5847; ...
                0.8260 0.7594 0.7414 0.7105 0.6852 0.6646 0.6478 0.6341 0.6230 0.6140 0.6067 0.6010 0.5964; ...
                0.8317 0.7653 0.7476 0.7176 0.6934 0.6737 0.6578 0.6449 0.6345 0.6260 0.6193 0.6140 0.6097; ...
                0.8403 0.7736 0.7563 0.7272 0.7039 0.6852 0.6701 0.6579 0.6482 0.6403 0.6341 0.6291 0.6252; ...
                0.8492 0.7813 0.7642 0.7358 0.7134 0.6955 0.6813 0.6698 0.6607 0.6534 0.6476 0.6430 0.6394; ...
                1.0000 0.7857 0.7685 0.7405 0.7188 0.7017 0.6881 0.6773 0.6687 0.6618 0.6564 0.6521 0.6488; ...
                0.8771 0.7909 1.0000 0.7430 0.7213 0.7045 0.6914 0.6810 0.6728 0.6663 0.6611 0.6571 0.6540; ...
                0.8925 0.8164 0.7903 0.7467 0.7226 1.0000 1.0000 1.0000 1.0000 0.6672 0.6622 0.6583 0.6553; ...
                0.9055 0.8470 0.8272 0.7863 0.7426 1.0000 1.0000 1.0000 1.0000 0.6648 1.0000 0.6559 0.6528; ...
                0.9196 0.8776 0.8635 0.8346 0.8040 1.0000 1.0000 1.0000 1.0000 0.6598 1.0000 0.6497 0.6464; ...
                1.0000 1.0000 1.0000 0.8896 0.8716 0.8522 0.8309 0.8070 1.0000 0.7473 0.7081 0.6685 0.6471; ...
                1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000];
    C(:, :, 9) = [...
                0.7962 0.7463 0.7272 0.6921 0.6614 0.6345 0.6110 0.5905 0.5726 0.5570 0.5436 0.5320 0.5221; ...
                0.8012 0.7467 0.7273 0.6921 0.6614 0.6345 0.6111 0.5906 0.5727 0.5573 0.5439 0.5325 0.5228; ...
                0.8123 0.7467 0.7273 0.6921 0.6614 0.6347 0.6113 0.5910 0.5735 0.5583 0.5454 0.5344 0.5252; ...
                0.8138 0.7467 0.7273 0.6922 0.6617 0.6352 0.6122 0.5924 0.5755 0.5610 0.5488 0.5386 0.5301; ...
                0.8142 0.7471 0.7278 0.6931 0.6633 0.6377 0.6159 0.5975 0.5819 0.5689 0.5581 0.5492 0.5419; ...
                0.8153 0.7484 0.7293 0.6955 0.6669 0.6427 0.6225 0.6056 0.5915 0.5799 0.5704 0.5626 0.5564; ...
                0.8178 0.7513 0.7328 0.7003 0.6734 0.6510 0.6325 0.6172 0.6046 0.5944 0.5861 0.5794 0.5740; ...
                0.8198 0.7538 0.7356 0.7041 0.6781 0.6566 0.6390 0.6246 0.6128 0.6032 0.5954 0.5892 0.5843; ...
                0.8227 0.7573 0.7395 0.7090 0.6840 0.6636 0.6469 0.6333 0.6222 0.6132 0.6060 0.6003 0.5957; ...
                0.8267 0.7621 0.7448 0.7153 0.6914 0.6721 0.6563 0.6435 0.6332 0.6249 0.6182 0.6129 0.6087; ...
                0.8323 0.7687 0.7520 0.7236 0.7009 0.6826 0.6677 0.6558 0.6462 0.6384 0.6323 0.6274 0.6235; ...
                0.8406 0.7780 0.7618 0.7346 0.7130 0.6957 0.6819 0.6707 0.6618 0.6546 0.6489 0.6445 0.6409; ...
                0.8535 0.7913 0.7756 0.7496 0.7291 0.7128 0.6998 0.6894 0.6811 0.6745 0.6693 0.6652 0.6620; ...
                0.8694 0.8056 1.0000 0.7649 1.0000 0.7298 0.7176 0.7079 0.7002 0.6941 0.6892 0.6854 0.6825; ...
                0.8925 0.8189 0.8027 0.7770 1.0000 0.7425 0.7308 0.7215 0.7142 1.0000 1.0000 1.0000 1.0000; ...
                0.9055 0.8470 0.8272 0.7908 1.0000 0.7529 0.7408 0.7314 0.7241 1.0000 1.0000 1.0000 1.0000; ...
                0.9196 0.8776 0.8635 0.8346 1.0000 0.7706 0.7517 0.7399 0.7313 1.0000 1.0000 1.0000 1.0000; ...
                1.0000 1.0000 1.0000 0.8896 0.8716 0.8522 0.8309 0.8070 0.7795 0.7473 1.0000 1.0000 1.0000; ...
                1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000];
    C(:, :, 10) = [...
                    0.7962 0.7463 0.7272 0.6921 0.6614 0.6345 0.6110 0.5905 0.5726 0.5570 0.5436 0.5320 0.5221; ...
                    0.8012 0.7467 0.7273 0.6921 0.6614 0.6345 0.6111 0.5906 0.5727 0.5573 0.5439 0.5325 0.5228; ...
                    0.8123 0.7467 0.7273 0.6921 0.6614 0.6347 0.6113 0.5910 0.5735 0.5583 0.5454 0.5344 0.5252; ...
                    0.8138 0.7467 0.7273 0.6922 0.6617 0.6352 0.6122 0.5924 0.5755 0.5610 0.5488 0.5386 0.5301; ...
                    0.8141 0.7470 0.7277 0.6930 0.6632 0.6377 0.6159 0.5975 0.5819 0.5689 0.5580 0.5491 0.5419; ...
                    0.8148 0.7480 0.7290 0.6953 0.6667 0.6426 0.6224 0.6055 0.5914 0.5798 0.5703 0.5626 0.5563; ...
                    0.8165 0.7505 0.7320 0.6997 0.6729 0.6506 0.6321 0.6169 0.6043 0.5941 0.5858 0.5791 0.5738; ...
                    0.8178 0.7525 0.7345 0.7032 0.6773 0.6560 0.6384 0.6241 0.6123 0.6027 0.5950 0.5888 0.5839; ...
                    0.8197 0.7554 0.7378 0.7076 0.6828 0.6626 0.6460 0.6325 0.6215 0.6125 0.6054 0.5996 0.5951; ...
                    0.8224 0.7593 0.7423 0.7133 0.6897 0.6705 0.6550 0.6423 0.6320 0.6238 0.6171 0.6119 0.6077; ...
                    0.8261 0.7647 0.7483 0.7206 0.6983 0.6803 0.6657 0.6539 0.6444 0.6367 0.6306 0.6258 0.6220; ...
                    0.8314 0.7719 0.7563 0.7300 0.7090 0.6922 0.6786 0.6677 0.6590 0.6519 0.6464 0.6419 0.6385; ...
                    0.8390 0.7818 0.7671 0.7424 0.7227 0.7071 0.6946 0.6846 0.6765 0.6701 0.6651 0.6610 0.6579; ...
                    0.8505 0.7959 0.7820 0.7589 0.7408 0.7264 0.7149 0.7058 0.6985 0.6927 0.6881 0.6845 0.6817; ...
                    0.8691 0.8171 0.8041 0.7827 0.7660 0.7528 0.7423 0.7340 0.7274 0.7222 0.7181 0.7149 0.7124; ...
                    0.8938 0.8424 0.8299 0.8096 0.7939 0.7817 0.7720 0.7644 0.7584 0.7536 0.7499 0.7470 0.7447; ...
                    0.9196 0.8736 0.8587 0.8361 0.9534 0.9531 0.7974 0.7898 0.7839 0.7793 1.0000 1.0000 1.0000; ...
                    1.0000 1.0000 0.9066 0.8896 1.0000 1.0000 0.8305 0.8172 0.8085 0.8869 0.7975 1.0000 1.0000; ...
                    1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000];
    C(:, :, 11) = [...
                    0.7962 0.7463 0.7272 0.6921 0.6614 0.6345 0.6110 0.5905 0.5726 0.5570 0.5436 0.5320 0.5221; ...
                    0.8012 0.7467 0.7273 0.6921 0.6614 0.6345 0.6111 0.5906 0.5727 0.5573 0.5439 0.5325 0.5228; ...
                    0.8123 0.7467 0.7273 0.6921 0.6614 0.6347 0.6113 0.5910 0.5735 0.5583 0.5454 0.5344 0.5252; ...
                    0.8138 0.7467 0.7273 0.6922 0.6617 0.6352 0.6122 0.5924 0.5755 0.5610 0.5488 0.5386 0.5301; ...
                    0.8139 0.7469 0.7276 0.6930 0.6632 0.6376 0.6159 0.5974 0.5819 0.5688 0.5580 0.5491 0.5419; ...
                    0.8143 0.7477 0.7287 0.6950 0.6665 0.6424 0.6222 0.6054 0.5913 0.5797 0.5702 0.5625 0.5562; ...
                    0.8152 0.7496 0.7313 0.6992 0.6724 0.6502 0.6317 0.6165 0.6041 0.5938 0.5855 0.5789 0.5736; ...
                    0.8160 0.7513 0.7334 0.7023 0.6766 0.6553 0.6379 0.6236 0.6118 0.6023 0.5946 0.5884 0.5835; ...
                    0.8171 0.7537 0.7363 0.7063 0.6817 0.6616 0.6451 0.6317 0.6208 0.6119 0.6047 0.5990 0.5945; ...
                    0.8188 0.7569 0.7401 0.7115 0.6881 0.6692 0.6537 0.6411 0.6310 0.6228 0.6162 0.6109 0.6068; ...
                    0.8211 0.7612 0.7452 0.7180 0.6960 0.6782 0.6638 0.6522 0.6428 0.6352 0.6292 0.6244 0.6206; ...
                    0.8244 0.7669 0.7518 0.7262 0.7057 0.6891 0.6758 0.6651 0.6565 0.6496 0.6441 0.6397 0.6363; ...
                    0.8292 0.7747 0.7605 0.7367 0.7177 0.7025 0.6903 0.6805 0.6727 0.6664 0.6615 0.6575 0.6545; ...
                    0.8361 0.7852 0.7721 0.7503 0.7329 0.7191 0.7081 0.6993 0.6923 0.6867 0.6822 0.6787 0.6760; ...
                    0.8464 0.7999 0.7881 0.7683 0.7528 0.7405 0.7308 0.7230 0.7168 0.7118 0.7079 0.7049 0.7025; ...
                    0.8627 0.8215 0.8111 0.7939 0.7804 0.7697 0.7613 0.7546 0.7492 0.7450 0.7417 0.7391 0.7371; ...
                    0.8922 0.8578 0.8492 0.8349 0.8237 0.8149 0.8079 0.8024 0.7980 0.7945 0.7918 0.7897 0.7881; ...
                    1.0000 0.9079 0.9007 1.0000 1.0000 1.0000 0.8661 0.8615 0.8578 0.8549 0.8527 1.0000 1.0000; ...
                    1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000];
    C(:, :, 12) = [...
                    0.7962 0.7463 0.7272 0.6921 0.6614 0.6345 0.6110 0.5905 0.5726 0.5570 0.5436 0.5320 0.5221; ...
                    0.8012 0.7467 0.7273 0.6921 0.6614 0.6345 0.6111 0.5906 0.5727 0.5573 0.5439 0.5325 0.5228; ...
                    0.8123 0.7467 0.7273 0.6921 0.6614 0.6347 0.6113 0.5910 0.5735 0.5583 0.5454 0.5344 0.5252; ...
                    0.8137 0.7467 0.7273 0.6922 0.6617 0.6352 0.6122 0.5924 0.5755 0.5610 0.5488 0.5386 0.5301; ...
                    0.8138 0.7469 0.7276 0.6929 0.6631 0.6376 0.6158 0.5974 0.5819 0.5688 0.5580 0.5491 0.5418; ...
                    0.8141 0.7475 0.7286 0.6949 0.6664 0.6424 0.6222 0.6053 0.5913 0.5797 0.5702 0.5624 0.5562; ...
                    0.8146 0.7492 0.7309 0.6989 0.6722 0.6500 0.6316 0.6164 0.6039 0.5937 0.5854 0.5787 0.5734; ...
                    0.8151 0.7507 0.7329 0.7019 0.6762 0.6550 0.6376 0.6233 0.6116 0.6021 0.5944 0.5882 0.5833; ...
                    0.8159 0.7528 0.7356 0.7057 0.6812 0.6612 0.6447 0.6313 0.6204 0.6116 0.6044 0.5987 0.5942; ...
                    0.8171 0.7557 0.7391 0.7106 0.6874 0.6685 0.6531 0.6406 0.6305 0.6223 0.6157 0.6105 0.6064; ...
                    0.8188 0.7596 0.7438 0.7167 0.6949 0.6772 0.6629 0.6513 0.6420 0.6345 0.6285 0.6237 0.6199; ...
                    0.8214 0.7648 0.7498 0.7245 0.7041 0.6878 0.6745 0.6639 0.6553 0.6485 0.6430 0.6387 0.6353; ...
                    0.8251 0.7717 0.7577 0.7342 0.7155 0.7005 0.6884 0.6787 0.6710 0.6648 0.6599 0.6560 0.6529; ...
                    0.8306 0.7810 0.7682 0.7467 0.7297 0.7161 0.7052 0.6966 0.6896 0.6841 0.6797 0.6763 0.6736; ...
                    0.8387 0.7937 0.7822 0.7630 0.7478 0.7358 0.7262 0.7186 0.7125 0.7077 0.7039 0.7009 0.6986; ...
                    0.8511 0.8117 0.8017 0.7851 0.7720 0.7617 0.7535 0.7470 0.7419 0.7378 0.7346 0.7320 0.7301; ...
                    0.8717 0.8393 0.8311 0.8176 0.8071 0.7987 0.7921 0.7869 0.7828 0.7795 0.7769 0.7749 0.7734; ...
                    0.9145 0.8923 0.8867 0.8774 0.8701 0.8644 0.8599 0.8563 0.8534 0.8512 0.8494 0.8480 0.8470; ...
                    1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000];
    C(:, :, 13) = [...
                    0.7962 0.7463 0.7272 0.6921 0.6614 0.6345 0.6110 0.5905 0.5726 0.5570 0.5436 0.5320 0.5221; ...
                    0.8012 0.7467 0.7273 0.6921 0.6614 0.6345 0.6111 0.5906 0.5727 0.5573 0.5439 0.5325 0.5228; ...
                    0.8123 0.7467 0.7273 0.6921 0.6614 0.6347 0.6113 0.5910 0.5735 0.5583 0.5454 0.5344 0.5252; ...
                    0.8137 0.7467 0.7273 0.6922 0.6617 0.6352 0.6122 0.5924 0.5755 0.5610 0.5488 0.5386 0.5301; ...
                    0.8138 0.7469 0.7275 0.6929 0.6631 0.6376 0.6158 0.5974 0.5818 0.5688 0.5580 0.5491 0.5418; ...
                    0.8139 0.7474 0.7285 0.6949 0.6663 0.6423 0.6221 0.6053 0.5912 0.5796 0.5701 0.5624 0.5562; ...
                    0.8143 0.7490 0.7307 0.6987 0.6720 0.6498 0.6315 0.6163 0.6038 0.5936 0.5853 0.5787 0.5734; ...
                    0.8146 0.7504 0.7326 0.7016 0.6760 0.6549 0.6375 0.6232 0.6115 0.6020 0.5943 0.5881 0.5832; ...
                    0.8152 0.7524 0.7351 0.7054 0.6809 0.6609 0.6445 0.6311 0.6202 0.6114 0.6043 0.5986 0.5941; ...
                    0.8161 0.7551 0.7385 0.7101 0.6870 0.6681 0.6528 0.6403 0.6302 0.6220 0.6154 0.6102 0.6061; ...
                    0.8176 0.7587 0.7429 0.7160 0.6943 0.6767 0.6624 0.6509 0.6415 0.6340 0.6280 0.6233 0.6196; ...
                    0.8197 0.7636 0.7487 0.7235 0.7033 0.6870 0.6738 0.6632 0.6547 0.6478 0.6424 0.6381 0.6347; ...
                    0.8229 0.7700 0.7562 0.7329 0.7143 0.6993 0.6873 0.6777 0.6700 0.6638 0.6589 0.6551 0.6521; ...
                    0.8277 0.7787 0.7660 0.7448 0.7279 0.7144 0.7037 0.6950 0.6882 0.6827 0.6783 0.6749 0.6723; ...
                    0.8347 0.7904 0.7790 0.7601 0.7451 0.7333 0.7238 0.7162 0.7102 0.7054 0.7017 0.6987 0.6964; ...
                    0.8455 0.8068 0.7969 0.7806 0.7678 0.7576 0.7496 0.7432 0.7381 0.7341 0.7309 0.7284 0.7264; ...
                    0.8628 0.8311 0.8231 0.8098 0.7995 0.7913 0.7849 0.7797 0.7757 0.7725 0.7700 0.7680 0.7665; ...
                    0.8952 0.8730 0.8674 0.8583 0.8511 0.8455 0.8410 0.8375 0.8348 0.8326 0.8308 0.8295 0.8285; ...
                    1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000];
    C(:, :, 14) = [...
                    0.7962 0.7463 0.7272 0.6921 0.6614 0.6345 0.6110 0.5905 0.5726 0.5570 0.5436 0.5320 0.5221; ...
                    0.8012 0.7467 0.7273 0.6921 0.6614 0.6345 0.6111 0.5906 0.5727 0.5573 0.5439 0.5325 0.5228; ...
                    0.8123 0.7467 0.7273 0.6921 0.6614 0.6347 0.6113 0.5910 0.5735 0.5583 0.5454 0.5344 0.5252; ...
                    0.8137 0.7467 0.7273 0.6922 0.6617 0.6352 0.6122 0.5924 0.5755 0.5610 0.5488 0.5386 0.5301; ...
                    0.8138 0.7468 0.7275 0.6929 0.6631 0.6376 0.6158 0.5974 0.5818 0.5688 0.5580 0.5491 0.5418; ...
                    0.8139 0.7474 0.7285 0.6948 0.6663 0.6423 0.6221 0.6052 0.5912 0.5796 0.5701 0.5624 0.5562; ...
                    0.8141 0.7489 0.7307 0.6987 0.6720 0.6498 0.6314 0.6163 0.6038 0.5936 0.5853 0.5787 0.5733; ...
                    0.8145 0.7503 0.7325 0.7015 0.6759 0.6548 0.6374 0.6231 0.6114 0.6019 0.5942 0.5881 0.5832; ...
                    0.8150 0.7522 0.7350 0.7052 0.6808 0.6608 0.6444 0.6310 0.6201 0.6113 0.6042 0.5985 0.5940; ...
                    0.8158 0.7548 0.7383 0.7099 0.6868 0.6680 0.6526 0.6402 0.6301 0.6219 0.6153 0.6101 0.6060; ...
                    0.8172 0.7584 0.7427 0.7158 0.6941 0.6765 0.6623 0.6507 0.6414 0.6339 0.6279 0.6232 0.6194; ...
                    0.8192 0.7632 0.7483 0.7232 0.7030 0.6867 0.6736 0.6630 0.6545 0.6476 0.6422 0.6379 0.6345; ...
                    0.8222 0.7695 0.7557 0.7324 0.7139 0.6990 0.6870 0.6774 0.6697 0.6635 0.6586 0.6548 0.6518; ...
                    0.8268 0.7780 0.7653 0.7441 0.7273 0.7139 0.7031 0.6946 0.6877 0.6822 0.6779 0.6745 0.6718; ...
                    0.8335 0.7894 0.7781 0.7592 0.7443 0.7324 0.7230 0.7155 0.7095 0.7047 0.7010 0.6980 0.6957; ...
                    0.8438 0.8053 0.7955 0.7792 0.7665 0.7564 0.7483 0.7420 0.7369 0.7329 0.7297 0.7272 0.7253; ...
                    0.8602 0.8286 0.8207 0.8075 0.7972 0.7891 0.7827 0.7776 0.7736 0.7704 0.7679 0.7659 0.7644; ...
                    0.8902 0.8680 0.8624 0.8533 0.8461 0.8405 0.8361 0.8326 0.8298 0.8276 0.8259 0.8246 0.8235; ...
                    1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000];

    %Recherche dans la matrice
    Ns = length(S);
    Nw = length(w);
    Na = length(ang);
    % La valeur est comprise dans le domaine C(i+0/1,j+0/1,k+0/1)
    b1 = (w1 - w(i)) / (w(i + 1) - w(i));
    b2 = (angle1 - ang(j)) / (ang(j + 1) - ang(j));
    b3 = (s1 - S(k)) / (S(k + 1) - S(k));
    a1 = 1 - b1;
    a2 = 1 - b2;
    a3 = 1 - b3;
    z = a1 * a2 * a3 * C(i, j, k) + b1 * a2 * a3 * C(i + 1, j, k) + a1 * b2 * a3 * C(i, j + 1, k) + a1 * a2 * b3 * C(i, j, k + 1) ...
        +b1 * b2 * a3 * C(i + 1, j + 1, k) + a1 * b2 * b3 * C(i, j + 1, k + 1) + b1 * a2 * b3 * C(i + 1, j, k + 1) + b1 * b2 * b3 * C(i + 1, j + 1, k + 1);

end

function z = Ccv(a, s)
    % Contraction coefficient function as a combination of submerged and free flow, vertical gate - see Belaud et al. (2012)
    Cc1 = ccf(a);
    % Calcul de p =proportion entre Cc en denoye et Cc en noye
    if (s < (a * Cc1))
        p = 1;
    elseif (s > a)
        p = 0;
    else
        t = (1 - s / a) / (1 - Cc1);
        p = -0.6212 * t^3 + 1.7349 * t^2 - 0.1133 * t;
    end

    z = p * ccf(a) + (1 - p) * ccs(a);
end

function z = ccf(a)
    % Cc in free flow, vertical gate:
    Cc0 = 0.618;
    z = Cc0 + 0.0254 * a^3 + 0.0261 * a^2 - 0.0598 * a;
end

%-------------------------------------------------------------------
function z = ccs(a)
    % Cc in submerged flow, vertical gate
    P = 2 * (0.194 * a^2 - 0.499 * a + 0.308) + a;
    z = (1 - sqrt(1 - P)) / P;
end
